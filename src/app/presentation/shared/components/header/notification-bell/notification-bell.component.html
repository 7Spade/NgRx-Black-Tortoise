<button
  mat-icon-button
  [matMenuTriggerFor]="notificationMenu"
  [matBadge]="unreadCount()"
  [matBadgeHidden]="!hasUnread()"
  matBadgeColor="warn"
  matBadgeSize="small"
  class="notification-bell"
  aria-label="Notifications"
>
  <mat-icon>notifications</mat-icon>
</button>

<mat-menu #notificationMenu="matMenu" class="notification-menu">
  <!-- Header -->
  <div class="menu-header">
    <h3>Notifications</h3>
    @if (hasUnread()) {
      <button mat-button (click)="markAllAsRead()">Mark all as read</button>
    }
  </div>

  <mat-divider />

  <!-- Recent notifications -->
  @if (recentNotifications().length > 0) {
    <div class="notifications-list">
      @for (notification of recentNotifications(); track notification.id) {
        <button
          mat-menu-item
          class="notification-item"
          [class.unread]="!notification.read"
          (click)="markAsRead(notification.id)"
        >
          <div class="notification-content">
            <div class="notification-title">{{ notification.title }}</div>
            <div class="notification-message">{{ notification.message }}</div>
            <div class="notification-time">{{ notification.createdAt | date: 'short' }}</div>
          </div>
        </button>
      }
    </div>
  } @else {
    <div class="empty-state">
      <mat-icon>notifications_none</mat-icon>
      <p>No notifications</p>
    </div>
  }

  <mat-divider />

  <!-- View all -->
  <div class="menu-footer">
    <button mat-button (click)="viewAllNotifications()">View all notifications</button>
  </div>
</mat-menu>
